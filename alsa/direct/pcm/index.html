<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module bypasses alsa-lib and directly read and write into memory mapped kernel memory. In case of the sample memory, this is in many cases the DMA buffers that is transferred to the sound card."><meta name="keywords" content="rust, rustlang, rust-lang, pcm"><title>alsa::direct::pcm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-93196c7a1c3542a8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-4743e13df3dfe8c4.css"><link rel="stylesheet" disabled href="../../../static.files/dark-0e1b889528bd466b.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-65289d5d067c7c66.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../alsa/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../alsa/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module pcm</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">alsa</a>::<wbr><a href="../index.html">direct</a>::<wbr><a class="mod" href="#">pcm</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/alsa/direct/pcm.rs.html#1-630">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module bypasses alsa-lib and directly read and write into memory mapped kernel memory.
In case of the sample memory, this is in many cases the DMA buffers that is transferred to the sound card.</p>
<p>The reasons for doing this are:</p>
<ul>
<li>Minimum overhead where it matters most: let alsa-lib do the code heavy setup -
then steal its file descriptor and deal with sample streaming from Rust.</li>
<li>RT-safety to the maximum extent possible. Creating/dropping any of these structs causes syscalls,
but function calls on these are just read and write from memory. No syscalls, no memory allocations,
not even loops (with the exception of <code>MmapPlayback::write</code> that loops over samples to write).</li>
<li>Possibility to allow Send + Sync for structs</li>
<li>It’s a fun experiment and an interesting deep dive into how alsa-lib does things.</li>
</ul>
<p>Note: Not all sound card drivers support this direct method of communication; although almost all
modern/common ones do. It only works with hardware devices though (such as “hw:xxx” device strings),
don’t expect it to work with, e g, the PulseAudio plugin or so.</p>
<p>For an example of how to use this mode, look in the “synth-example” directory.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Capture.html" title="alsa::direct::pcm::Capture struct">Capture</a></div><div class="item-right docblock-short">Dummy struct for better generics</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CaptureIter.html" title="alsa::direct::pcm::CaptureIter struct">CaptureIter</a></div><div class="item-right docblock-short">Iterator over captured samples</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Control.html" title="alsa::direct::pcm::Control struct">Control</a></div><div class="item-right docblock-short">Write PCM appl ptr directly, bypassing alsa-lib.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.MmapIO.html" title="alsa::direct::pcm::MmapIO struct">MmapIO</a></div><div class="item-right docblock-short">Struct containing direct I/O functions shared between playback and capture.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Playback.html" title="alsa::direct::pcm::Playback struct">Playback</a></div><div class="item-right docblock-short">Dummy struct for better generics</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RawSamples.html" title="alsa::direct::pcm::RawSamples struct">RawSamples</a></div><div class="item-right docblock-short">A raw pointer to samples, and the amount of samples readable or writable.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Status.html" title="alsa::direct::pcm::Status struct">Status</a></div><div class="item-right docblock-short">Read PCM status directly from memory, bypassing alsa-lib.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SyncPtrStatus.html" title="alsa::direct::pcm::SyncPtrStatus struct">SyncPtrStatus</a></div><div class="item-right docblock-short">Read PCM status via a simple kernel syscall, bypassing alsa-lib.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.MmapDir.html" title="alsa::direct::pcm::MmapDir trait">MmapDir</a></div><div class="item-right docblock-short">Dummy trait for better generics</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.MmapCapture.html" title="alsa::direct::pcm::MmapCapture type">MmapCapture</a></div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.MmapPlayback.html" title="alsa::direct::pcm::MmapPlayback type">MmapPlayback</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="alsa" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.2 (9eb3afe9e 2023-03-27)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>